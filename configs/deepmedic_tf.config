from dpipe.model_core.deepmedic_els_tf import DeepMedicEls
from dpipe.tf.model import TFModel, TFFrozenModel
from dpipe.batch_predict.patch_3d_fixed import Patch3DFixedPredictor


model_core = DeepMedicEls(
    n_chans_in=n_chans_in,
    n_chans_out=n_chans_out
)

batch_predict = Patch3DFixedPredictor(
    x_patch_sizes=predictor_x_patch_sizes,
    y_patch_size=predictor_y_patch_size,
    padding_mode="min",
)

model = TFModel(
    model_core=model_core,
    logits2pred=logits2pred,
    logits2loss=logits2loss,
    optimize=optimize,
)

frozen_model = TFFrozenModel(
    model_core=model_core,
    logits2pred=logits2pred,
    restore_model_path=restore_model_path
)
